(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6930:(e,a,t)=>{Promise.resolve().then(t.bind(t,4067))},4067:(e,a,t)=>{"use strict";t.d(a,{Game:()=>M});var l=t(7437),r=t(2265),s=t(4839),i=t(6164);function n(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,i.m6)((0,s.W)(a))}let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,l.jsx)("div",{ref:a,className:n("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});c.displayName="Card",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,l.jsx)("div",{ref:a,className:n("flex flex-col space-y-1.5 p-6",t),...r})}).displayName="CardHeader",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,l.jsx)("h3",{ref:a,className:n("text-lg font-semibold leading-none tracking-tight",t),...r})}).displayName="CardTitle",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,l.jsx)("p",{ref:a,className:n("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription";let d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,l.jsx)("div",{ref:a,className:n("p-6 pt-0",t),...r})});d.displayName="CardContent",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,l.jsx)("div",{ref:a,className:n(" flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter";var o=t(2974);let u=(0,t(2218).j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),h=r.forwardRef((e,a)=>{let{className:t,variant:r,size:s,asChild:i=!1,...c}=e,d=i?o.g7:"button";return(0,l.jsx)(d,{className:n(u({variant:r,size:s,className:t})),ref:a,...c})});h.displayName="Button";var x=t(6648),m=t(4539);let f=(e,a)=>"red"===e?"このカードはモンスターに".concat(a,"ダメージを与えます。直前に出したカードよりも数字が大きくないと出せない"):"black"===e?"このカードは山札から".concat(14-a,"枚カードを捨て場に捨てます。"):({1:"手札に黒のカードがないと出せない。ランダムに黒のカードを場に出す。",2:"このターンカードを山札から引くことができない（手札が１枚減る）",3:"直後に黒のカードを出す場合、カードを捨てる枚数は３倍になる",4:"相手のHPを10回復する",5:"直後に出す赤のカードは効果が半分になる（繰上げ）",6:"効果なし",7:"直後に赤のカードを出す場合、攻撃力を7増加する",8:"捨て場からランダムにカードを2枚山札に加えます。",9:"捨て場からランダムに2枚カードを引きます。",10:"場に出ている赤と黒のカードの枚数だけモンスターにダメージを与えます。",11:"直後に黒のカードを出す場合、山札を捨てる枚数は半分になります。",12:"直後に黒のカードを出す場合、山札を捨てません。",13:"捨て場にあるカードの枚数分モンスターにダメージを与えます。"})[a]||"",g=e=>{switch(e){case"red":return"bg-red-600 hover:bg-red-700";case"black":return"bg-gray-800 hover:bg-gray-900";case"blue":return"bg-blue-600 hover:bg-blue-700";default:return"bg-gray-600"}};function b(e){let{color:a,value:t,onClick:s,disabled:i=!1}=e,[n,c]=r.useState(!1);return(0,l.jsxs)(m.E.div,{whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},className:"relative",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",duration:.5},children:[(0,l.jsxs)("button",{className:"\n          w-20 h-28 rounded-lg ".concat(g(a)," text-white \n          font-bold shadow-lg transition-all duration-200\n          flex flex-col items-center justify-center\n          ").concat(i?"opacity-50 cursor-not-allowed":"cursor-pointer","\n          border-2 border-white/10\n        "),onClick:s,disabled:i,children:[(0,l.jsx)("div",{className:"text-2xl mb-1",children:t}),(0,l.jsx)("div",{className:"text-xs capitalize",children:a})]}),n&&(0,l.jsx)("div",{className:"absolute z-10 w-48 p-2 bg-black/90 text-white text-xs rounded-lg -top-20 left-1/2 transform -translate-x-1/2",children:f(a,t)})]})}var p=t(5127);let v=(e,a)=>{switch(e){case"red":return{type:"damage",value:a,description:"".concat(a,"のダメージを与える")};case"black":return{type:"discard",value:14-a,description:"山札から".concat(14-a,"枚捨てる")};case"blue":return y(a);default:return{type:"special",value:0,description:"効果なし"}}},y=e=>({1:{type:"special",value:0,description:"手札に黒のカードがないと出せない。ランダムに黒のカードを場に出す。",conditions:{handSize:1}},4:{type:"heal",value:10,description:"相手のHPを10回復する"}})[e]||{type:"special",value:0,description:"効果なし"},N=e=>new Promise(a=>setTimeout(a,e)),j=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;await N(a),e()};class w{handleBlueCardEffect(e){this.lastPlayedBlueCard=e,2===e&&(this.skipNextDraw=!0)}getModifiedRedDamage(e){let a=e;return 5===this.lastPlayedBlueCard?(a=Math.ceil(a/2),this.lastPlayedBlueCard=null):7===this.lastPlayedBlueCard&&(a+=7,this.lastPlayedBlueCard=null),a}getModifiedBlackDiscard(e){let a=e;return 11===this.lastPlayedBlueCard&&(a=Math.ceil(a/2),this.lastPlayedBlueCard=null),a}shouldSkipDraw(){return!!this.skipNextDraw&&(this.skipNextDraw=!1,!0)}reset(){this.lastPlayedBlueCard=null,this.skipNextDraw=!1}constructor(){this.lastPlayedBlueCard=null,this.skipNextDraw=!1}}let k=[{name:"GOBLIN",maxHP:30},{name:"DEVIL",maxHP:45},{name:"DARK_KNIGHT",maxHP:60},{name:"DARK_QUEEN",maxHP:75}];function M(){let[e,a]=(0,r.useState)(30),[t,s]=(0,r.useState)([]),[i,n]=(0,r.useState)([]),[o,u]=(0,r.useState)([]),[f,g]=(0,r.useState)([]),[y,M]=(0,r.useState)(""),[P,C]=(0,r.useState)(0),[D,S]=(0,r.useState)(0),[H,B]=(0,r.useState)(k[0]),[E,R]=(0,r.useState)(!1),[_,z]=(0,r.useState)(!1),[T,G]=(0,r.useState)(!1),[I]=(0,r.useState)(()=>new w),A=()=>{let e=[];return["red","black","blue"].forEach(a=>{for(let t=1;t<=13;t++)e.push({color:a,value:t})}),e},K=e=>{let a=[...e];for(let e=a.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[a[e],a[t]]=[a[t],a[e]]}return a},L=async e=>{if(t.length<e){q();return}z(!0);for(let a=0;a<e;a++)await j(()=>{n(e=>[...e,t[a]])},200);s(a=>a.slice(e)),z(!1)},O=async()=>{G(!1),0===t.length&&s(K(A())),n([]),u([]),g([]),a(H.maxHP),S(0),R(!0);try{await N(300),await L(4)}catch(e){console.error("Error during game start:",e)}},F={hidden:{scale:.8,opacity:0,y:50},visible:{scale:1,opacity:1,y:0,transition:{type:"spring",duration:.5}},exit:{scale:.8,opacity:0,transition:{duration:.2}}},V=async l=>{let r=i[l];if("blue"===r.color&&1===r.value&&!i.some(e=>"black"===e.color)){Q("このカードは手札に黒のカードがないと出せません");return}if("red"===r.color&&o.length>0){let e=o[o.length-1];if(r.value<=e.value){Q("赤のカードは直前のカードより大きな数でないと出せません");return}}let c=[...i];switch(c.splice(l,1),n(c),u(e=>[...e,r]),r.color){case"blue":I.handleBlueCardEffect(r.value);break;case"red":let d=I.getModifiedRedDamage(r.value);a(e=>Math.max(0,e-d));break;case"black":let h=14-r.value,x=I.getModifiedBlackDiscard(h);if(t.length>=x){let e=t.slice(0,x);g(a=>[...a,...e]),s(e=>e.slice(x))}}let m=v(r.color,r.value);await U(m,r),S(e=>e+1),I.shouldSkipDraw()||await L(1),e<=0&&Y()},Q=e=>{M(e),setTimeout(()=>M(""),2e3)},U=async(e,l)=>{let r="damage"===e.type?I.getModifiedRedDamage(e.value):"discard"===e.type?I.getModifiedBlackDiscard(e.value):e.value;switch(e.type){case"damage":a(e=>Math.max(0,e-r)),Q("".concat(r,"のダメージ！"));break;case"heal":a(e=>Math.min(H.maxHP,e+r)),Q("".concat(r,"回復！"));break;case"discard":if(t.length<r){Q("デッキが足りません！");return}let i=t.slice(0,r);g(e=>[...e,...i]),s(e=>e.slice(r)),Q("".concat(r,"枚捨てました"));break;case"special":await W(e,l)}},W=async(e,t)=>{switch(I.handleBlueCardEffect(e.value),e.value){case 1:let l=i.filter(e=>"black"===e.color);if(0===l.length){Q("このカードは手札に黒のカードがないと出せません"),n(e=>[...e,t]),u(e=>e.slice(0,-1));return}let r=l[Math.floor(Math.random()*l.length)];Q("ランダムな黒カードを場に出します");let c=i.findIndex(e=>e.color===r.color&&e.value===r.value);if(-1!==c){await N(500);let e=v("black",r.value);await U(e,r),n(e=>e.filter((e,a)=>a!==c)),u(e=>[...e,r])}break;case 2:Q("このターンはカードを引きません");break;case 4:a(e=>Math.min(H.maxHP,e+10)),Q("モンスターのHPを10回復");break;case 8:if(0===f.length){Q("捨て札がありません");return}let d=[];for(let e=0;e<2&&f.length>0;e++){let e=Math.floor(Math.random()*f.length);d.push(f[e]),g(a=>[...a.slice(0,e),...a.slice(e+1)])}s(e=>[...e,...d]),Q("".concat(d.length,"枚のカードを山札に戻しました"));break;case 9:if(0===f.length){Q("捨て札がありません");return}let h=[];for(let e=0;e<2&&f.length>0;e++){let e=Math.floor(Math.random()*f.length);h.push(f[e]),g(a=>[...a.slice(0,e),...a.slice(e+1)])}n(e=>[...e,...h]),Q("".concat(h.length,"枚のカードを手札に加えました"));break;case 10:let x=o.filter(e=>"red"===e.color||"black"===e.color).length;a(e=>Math.max(0,e-x)),Q("".concat(x,"ダメージを与えました"));break;case 13:let m=f.length;a(e=>Math.max(0,e-m)),Q("".concat(m,"ダメージを与えました"));break;default:Q(e.description||"")}};(0,r.useEffect)(()=>{s(K(A()))},[]);let Y=()=>{let e=Math.max(100-2*D,0),t=H.maxHP;C(a=>a+e+t);let l=k.findIndex(e=>e.name===H.name);l<k.length-1?(B(k[l+1]),a(k[l+1].maxHP)):(alert("ゲームクリア！\n最終スコア: ".concat(P+e+t)),R(!1))},q=()=>{G(!0),R(!1),alert("ゲームオーバー\n最終スコア: ".concat(P,"\nターン数: ").concat(D))};return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-gray-700 p-8",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto bg-gray-800 rounded-lg shadow-xl p-6",children:[(0,l.jsx)(p.M,{children:y&&(0,l.jsx)(m.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0},className:"fixed top-10 left-1/2 transform -translate-x-1/2  bg-black/80 text-white px-4 py-2 rounded-lg z-50",children:y})}),(0,l.jsxs)("div",{className:"mb-8 text-center",children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-white mb-4",children:H.name}),(0,l.jsx)("div",{className:"relative w-full h-[300px] mb-4 flex justify-center items-center",children:(0,l.jsx)("div",{className:"relative w-[300px] h-[300px]",children:(0,l.jsx)(x.default,{src:"/popoCard/images/".concat(H.name,".png"),alt:H.name,fill:!0,style:{objectFit:"contain"},className:"transition-all duration-300",priority:!0})})}),(0,l.jsxs)("div",{className:"relative w-full h-8 bg-gray-700 rounded-full overflow-hidden mb-2",children:[(0,l.jsx)("div",{className:"absolute h-full bg-red-600 transition-all duration-300",style:{width:"".concat(e/H.maxHP*100,"%")}}),(0,l.jsx)("div",{className:"absolute w-full h-full flex items-center justify-center",children:(0,l.jsxs)("span",{className:"text-white text-sm font-bold",children:[e," / ",H.maxHP]})})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[(0,l.jsx)(c,{className:"bg-gray-700",children:(0,l.jsxs)(d,{className:"text-center text-white p-4",children:[(0,l.jsx)("div",{className:"text-lg",children:"Deck"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:t.length})]})}),(0,l.jsx)(c,{className:"bg-gray-700",children:(0,l.jsxs)(d,{className:"text-center text-white p-4",children:[(0,l.jsx)("div",{className:"text-lg",children:"Turn"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:D})]})}),(0,l.jsx)(c,{className:"bg-gray-700",children:(0,l.jsxs)(d,{className:"text-center text-white p-4",children:[(0,l.jsx)("div",{className:"text-lg",children:"Score"}),(0,l.jsx)("div",{className:"text-2xl font-bold",children:P})]})})]}),(0,l.jsxs)("div",{className:"flex justify-center gap-4 mb-8",children:[(0,l.jsx)(h,{variant:"outline",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:O,disabled:E,children:"Start Game"}),(0,l.jsx)(h,{variant:"outline",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>{R(!1),B(k[0]),C(0),s(K(A()))},children:"Reset Game"})]}),(0,l.jsxs)("div",{className:"min-h-32 mb-8 p-4 bg-gray-700 rounded-lg",children:[(0,l.jsx)("div",{className:"text-white mb-2",children:"Play Area"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-4 justify-center",children:o.map((e,a)=>(0,l.jsx)(b,{color:e.color,value:e.value,disabled:!0},"play-".concat(a)))})]}),(0,l.jsxs)("div",{className:"min-h-40 p-4 bg-gray-700 rounded-lg",children:[(0,l.jsx)("div",{className:"text-white mb-2",children:"Your Hand"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-4 justify-center",children:(0,l.jsx)(p.M,{children:i.map((e,a)=>(0,l.jsx)(m.E.div,{variants:F,initial:"hidden",animate:"visible",exit:"exit",layout:!0,children:(0,l.jsx)(b,{color:e.color,value:e.value,onClick:()=>!_&&!T&&V(a),disabled:!E||_||T})},"hand-".concat(a,"-").concat(e.color,"-").concat(e.value)))})})]}),(0,l.jsxs)("div",{className:"mt-4 text-center text-white",children:[(0,l.jsx)("span",{className:"text-lg",children:"Discard Pile: "}),(0,l.jsx)("span",{className:"font-bold",children:f.length})]})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[982,130,215,744],()=>a(6930)),_N_E=e.O()}]);